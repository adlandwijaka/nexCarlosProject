<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Nex Carlos QnA</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }
    iframe {
      width: 100%;
      border: none;
    }
    .answers {
      margin-top: 40px;
    }
    .answer-card {
      background: #f9f9f9;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
  </style>
</head>
<body>
  <!-- Looker Embed -->
  <iframe 
    src="https://lookerstudio.google.com/reporting/867a8554-1581-44e2-afe5-a4b4ba1efccb/page/1M" 
    height="480" allowfullscreen></iframe>

  <!-- Google Form Embed -->
  <iframe 
    src="https://docs.google.com/forms/d/e/1FAIpQLScbDPkgzOP6YCWgqHehOylUyqH5aA4b8jTIY9SZjIB-ZvdYNg/viewform?embedded=true" 
    height="850" frameborder="0" marginheight="0" marginwidth="0">Loadingâ€¦</iframe>

  <!-- Recent Answers -->
  <div class="answers">
    <h2>ğŸ“– Recent Gemini Answers</h2>
    <div id="answer-list">Loading...</div>
  </div>

  <script>
    const SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTJ3dCKP-1gfbznYLElNRMKureENz9qHqQ6ZBudyTyyeNRgqu50USiemgxnBY5wDqFwOoBz1brBfUDI/pub?output=csv";

   fetch(SHEET_CSV_URL)
  .then(response => response.text())
  .then(csvText => {
    const rows = csvText.trim().split('\n').map(line => line.split(','));
    const header = rows[0];
    const answerIndex = header.findIndex(col => col.toLowerCase().includes('jawaban') || col.toLowerCase().includes('answer'));
    
    // Filter rows with non-empty answer
    const validRows = rows.slice(1).filter(row => row[answerIndex] && row[answerIndex].trim() !== '');

    const html = validRows.reverse().slice(0, 5).map(row => {
      const question = row[1]; // kolom Pertanyaan
      const answer = row[answerIndex];
      const date = row[0]; // Timestamp
      return `
        <div class="answer-card">
          <strong>ğŸ“… ${date}</strong><br>
          <em>â“ ${question}</em><br><br>
          <strong>ğŸ’¡ Answer:</strong><br>
          ${answer}
        </div>
      `;
    }).join('');

    document.getElementById('answer-list').innerHTML = html || 'No valid answers yet.';
  })
  .catch(err => {
    console.error(err);
    document.getElementById('answer-list').textContent = 'Failed to load answers.';
  });
  </script>
</body>
</html>
